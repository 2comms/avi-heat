# GENERATED FILE - DO NOT EDIT THIS FILE UNLESS YOU ARE A WIZZARD
#pylint:  skip-file
from heat.engine import properties
from heat.engine import constraints
from heat.engine import attributes
from heat.common.i18n import _
from avi.heat.avi_resource import AviResource
from avi.heat.avi_resource import AviNestedResource
from options import *

from match import *
from options import *


class NetworkSecurityMatchTarget(object):
    # all schemas
    client_ip_schema = properties.Schema(
        properties.Schema.MAP,
        _(""),
        schema=IpAddrMatch.properties_schema,
        required=False,
        update_allowed=True,
    )
    vs_port_schema = properties.Schema(
        properties.Schema.MAP,
        _(""),
        schema=PortMatch.properties_schema,
        required=False,
        update_allowed=True,
    )
    microservice_schema = properties.Schema(
        properties.Schema.MAP,
        _(""),
        schema=MicroServiceMatch.properties_schema,
        required=False,
        update_allowed=True,
    )

    # properties list
    PROPERTIES = (
        'client_ip',
        'vs_port',
        'microservice',
    )

    # mapping of properties to their schemas
    properties_schema = {
        'client_ip': client_ip_schema,
        'vs_port': vs_port_schema,
        'microservice': microservice_schema,
    }

    # for supporting get_avi_uuid_by_name functionality
    field_references = {
        'microservice': getattr(MicroServiceMatch, 'field_references', {}),
        'client_ip': getattr(IpAddrMatch, 'field_references', {}),
        'vs_port': getattr(PortMatch, 'field_references', {}),
    }

    unique_keys = {
        'microservice': getattr(MicroServiceMatch, 'unique_keys', {}),
        'client_ip': getattr(IpAddrMatch, 'unique_keys', {}),
        'vs_port': getattr(PortMatch, 'unique_keys', {}),
    }



class NetworkSecurityPolicyActionRLParam(object):
    # all schemas
    max_rate_schema = properties.Schema(
        properties.Schema.NUMBER,
        _("Maximum number of connections or requests or packets per second."),
        required=True,
        update_allowed=True,
    )
    burst_size_schema = properties.Schema(
        properties.Schema.NUMBER,
        _("Maximum number of connections or requests or packets to be rate limited instantaneously. (Default: 0)"),
        required=True,
        update_allowed=True,
    )

    # properties list
    PROPERTIES = (
        'max_rate',
        'burst_size',
    )

    # mapping of properties to their schemas
    properties_schema = {
        'max_rate': max_rate_schema,
        'burst_size': burst_size_schema,
    }



class NetworkSecurityRule(object):
    # all schemas
    name_schema = properties.Schema(
        properties.Schema.STRING,
        _(""),
        required=True,
        update_allowed=True,
    )
    index_schema = properties.Schema(
        properties.Schema.NUMBER,
        _(""),
        required=True,
        update_allowed=True,
    )
    enable_schema = properties.Schema(
        properties.Schema.BOOLEAN,
        _(""),
        required=True,
        update_allowed=True,
    )
    match_schema = properties.Schema(
        properties.Schema.MAP,
        _(""),
        schema=NetworkSecurityMatchTarget.properties_schema,
        required=True,
        update_allowed=True,
    )
    action_schema = properties.Schema(
        properties.Schema.STRING,
        _(""),
        required=True,
        update_allowed=True,
        constraints=[
            constraints.AllowedValues(['NETWORK_SECURITY_POLICY_ACTION_TYPE_ALLOW', 'NETWORK_SECURITY_POLICY_ACTION_TYPE_DENY', 'NETWORK_SECURITY_POLICY_ACTION_TYPE_RATE_LIMIT']),
        ],
    )
    log_schema = properties.Schema(
        properties.Schema.BOOLEAN,
        _(" (Default: False)"),
        required=False,
        update_allowed=True,
    )
    rl_param_schema = properties.Schema(
        properties.Schema.MAP,
        _(""),
        schema=NetworkSecurityPolicyActionRLParam.properties_schema,
        required=False,
        update_allowed=True,
    )
    age_schema = properties.Schema(
        properties.Schema.NUMBER,
        _("Time in minutes after which rule will be deleted. (Units: MIN) (Default: 0)"),
        required=False,
        update_allowed=True,
    )
    created_by_schema = properties.Schema(
        properties.Schema.STRING,
        _("Creator name"),
        required=False,
        update_allowed=True,
    )

    # properties list
    PROPERTIES = (
        'name',
        'index',
        'enable',
        'match',
        'action',
        'log',
        'rl_param',
        'age',
        'created_by',
    )

    # mapping of properties to their schemas
    properties_schema = {
        'name': name_schema,
        'index': index_schema,
        'enable': enable_schema,
        'match': match_schema,
        'action': action_schema,
        'log': log_schema,
        'rl_param': rl_param_schema,
        'age': age_schema,
        'created_by': created_by_schema,
    }

    # for supporting get_avi_uuid_by_name functionality
    field_references = {
        'rl_param': getattr(NetworkSecurityPolicyActionRLParam, 'field_references', {}),
        'match': getattr(NetworkSecurityMatchTarget, 'field_references', {}),
    }

    unique_keys = {
        'rl_param': getattr(NetworkSecurityPolicyActionRLParam, 'unique_keys', {}),
        'my_key': 'index',
        'match': getattr(NetworkSecurityMatchTarget, 'unique_keys', {}),
    }



class NetworkSecurityPolicy(AviResource):
    resource_name = "networksecuritypolicy"
    # all schemas
    avi_version_schema = properties.Schema(
        properties.Schema.STRING,
        _("Avi Version to use for the object. Default is 16.4.2. If you plan to use any fields introduced after 16.4.2, then this needs to be explicitly set."),
        required=False,
        update_allowed=True,
    )
    name_schema = properties.Schema(
        properties.Schema.STRING,
        _(""),
        required=False,
        update_allowed=True,
    )
    rules_item_schema = properties.Schema(
        properties.Schema.MAP,
        _(""),
        schema=NetworkSecurityRule.properties_schema,
        required=True,
        update_allowed=False,
    )
    rules_schema = properties.Schema(
        properties.Schema.LIST,
        _(""),
        schema=rules_item_schema,
        required=False,
        update_allowed=True,
    )
    created_by_schema = properties.Schema(
        properties.Schema.STRING,
        _("Creator name"),
        required=False,
        update_allowed=True,
    )
    cloud_config_cksum_schema = properties.Schema(
        properties.Schema.STRING,
        _("Checksum of cloud configuration for Network Sec Policy. Internally set by cloud connector"),
        required=False,
        update_allowed=True,
    )
    description_schema = properties.Schema(
        properties.Schema.STRING,
        _(""),
        required=False,
        update_allowed=True,
    )

    # properties list
    PROPERTIES = (
        'avi_version',
        'name',
        'rules',
        'created_by',
        'cloud_config_cksum',
        'description',
    )

    # mapping of properties to their schemas
    properties_schema = {
        'avi_version': avi_version_schema,
        'name': name_schema,
        'rules': rules_schema,
        'created_by': created_by_schema,
        'cloud_config_cksum': cloud_config_cksum_schema,
        'description': description_schema,
    }

    # for supporting get_avi_uuid_by_name functionality
    field_references = {
        'rules': getattr(NetworkSecurityRule, 'field_references', {}),
    }

    unique_keys = {
        'rules': getattr(NetworkSecurityRule, 'unique_keys', {}),
    }



def resource_mapping():
    return {
        'Avi::LBaaS::NetworkSecurityPolicy': NetworkSecurityPolicy,
    }

